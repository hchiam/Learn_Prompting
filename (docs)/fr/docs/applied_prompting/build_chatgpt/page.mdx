export const metadata = {
  sidebar_position: 4,
  title: "üü¢ Construire ChatGPT √† partir de GPT-3",
};

# üü¢ Construire ChatGPT √† partir de GPT-3

<div style={{ textAlign: "left" }}>
  <Image
    src="/docs/assets/basic_applications/skippy_chatbot_header.webp"
    width={800}
    height={281}
    style={{ width: "700px", margin: "0" }}
  />
</div>

## Introduction

[ChatGPT](https://chat.openai.com/chat) a connu un succ√®s fulgurant ces derniers mois, gagnant un million d'utilisateurs en seulement une semaine. √âtonnamment, le mod√®le sous-jacent, GPT-3, a fait ses d√©buts en 2020 et a √©t√© rendu accessible au public <a href="https://openai.com/blog/api-no-waitlist/">il y a plus d'un an !</a>

Pour ceux qui ne le savent pas, ChatGPT est un nouveau mod√®le de langage d'OpenAI qui a √©t√© affin√© √† partir de GPT-3 pour √™tre optimis√© pour la conversation (@chatgpt2022). Il dispose d'une interface de chat conviviale, o√π vous pouvez entrer des requ√™tes et obtenir une r√©ponse d'un assistant IA. Vous pouvez l'essayer sur [chat.openai.com](https://chat.openai.com/chat).

Bien que les premi√®res versions de GPT-3 n'√©taient pas aussi avanc√©es que l'actuelle s√©rie GPT-3.5, elles √©taient d√©j√† impressionnantes. Ces mod√®les ont √©t√© disponibles via une API et une <a href="https://beta.openai.com/playground">interface web Playground</a> qui permet d'ajuster certains hyperparam√®tres de configuration et de tester des prompts. GPT-3 a gagn√© une popularit√© significative, mais n'a pas atteint la viralit√© de ChatGPT.{" "}

Ce qui rend ChatGPT si r√©ussi, compar√© √† GPT-3, c'est son accessibilit√© en tant qu'assistant IA simple pour la personne moyenne, ind√©pendamment de ses connaissances en science des donn√©es, mod√®les de langage ou IA.

Dans cet article, je pr√©sente comment des chatbots comme ChatGPT peuvent √™tre impl√©ment√©s en utilisant un grand mod√®le de langage comme GPT-3.

## Motivation

Cet article a √©t√© √©crit en partie √† cause d'un tweet de <a href="https://twitter.com/goodside">Riley Goodside</a>, notant comment ChatGPT aurait pu √™tre impl√©ment√©.

<blockquote class="twitter-tweet">
  <p lang="en" dir="ltr">
    How to make your own knock-off ChatGPT using GPT‚Äë3 (text‚Äëdavinci‚Äë003) ‚Äî
    where you can customize the rules to your needs, and access the resulting
    chatbot over an API.
    <a href="https://t.co/9jHrs91VHW">pic.twitter.com/9jHrs91VHW</a>
  </p>
  &mdash; Riley Goodside <a href="https://twitter.com/goodside/status/1607487283782995968?ref_src=twsrc%5Etfw"> 26 d√©cembre 2022 </a>
</blockquote>

<script
  async
  src="https://platform.twitter.com/widgets.js"
  charset="utf-8"
></script>

Comme d'autres mod√®les de la s√©rie GPT-3.5, ChatGPT a √©t√© entra√Æn√© en utilisant [RLHF](https://huggingface.co/blog/rlhf), mais une grande partie de son efficacit√© provient de l'utilisation d'un **bon prompt**.

## Le Prompt

<div style={{ textAlign: "left" }}>
  <Image
    src="/docs/assets/basic_applications/skippy_chatbot.webp"
    width={800}
    height={303}
    style={{ width: "700px", margin: "0" }}
  />

  <p style={{ color: "gray", fontSize: "12px", fontStyle: "italic" }}>
    Prompt complet du chatbot Skippy de l'en-t√™te de l'article
  </p>
</div>

<a href="https://learnprompting.org/docs/basics/prompting">
  Le prompting est le processus d'instruction d'une IA pour faire quelque chose.
</a>
Comme vous l'avez probablement vu dans les exemples de ChatGPT en ligne, vous pouvez lui demander de faire √† peu pr√®s n'importe quoi. Les cas d'utilisation courants sont la synth√®se de texte, la r√©daction de contenu bas√©e sur une description, ou la cr√©ation de choses comme des po√®mes, des recettes, et bien plus encore.{" "}

<p></p>

ChatGPT est √† la fois un mod√®le de langage et une interface utilisateur. Le prompt saisi par un utilisateur dans l'interface est en r√©alit√© ins√©r√© dans un prompt plus large qui contient toute la conversation entre l'utilisateur et ChatGPT. Cela permet au mod√®le de langage sous-jacent de comprendre le contexte de la conversation et de r√©pondre de mani√®re appropri√©e.

<div style={{ textAlign: "left" }}>
  <Image
    src="/docs/assets/basic_applications/chatgpt_ui_diagram.webp"
    width={774}
    height={196}
    style={{ width: "600px", margin: "0" }}
  />

  <p style={{ color: "gray", fontSize: "12px", fontStyle: "italic" }}>
    Exemple d'insertion du prompt utilisateur avant envoi au mod√®le
  </p>
</div>

Le mod√®le de langage compl√®te le prompt en d√©terminant quels mots viennent ensuite en fonction des probabilit√©s qu'il a apprises pendant le pr√©-entra√Ænement (@jurafsky2009).

GPT-3 est capable d'¬´ apprendre ¬ª √† partir d'une simple instruction ou de quelques exemples dans le prompt. Cette derni√®re approche est appel√©e apprentissage √† partir de quelques exemples, ou apprentissage en contexte (@brown2020language). Dans le prompt du chatbot ci-dessus, je cr√©e un chatbot fictif nomm√© Skippy, et je lui demande de fournir des r√©ponses aux utilisateurs. GPT-3 comprend le format d'aller-retour, `USER: {entr√©e utilisateur}` et `SKIPPY: {r√©ponse de skippy}`. GPT-3 comprend que Skippy est un chatbot et que les √©changes pr√©c√©dents sont une conversation, de sorte que lorsque nous fournissons la prochaine entr√©e utilisateur, "Skippy" r√©pondra.

### M√©morisation

Les √©changes pass√©s entre Skippy et l'utilisateur sont ajout√©s au prochain prompt. Chaque fois que nous donnons plus d'entr√©es utilisateur et obtenons plus de sorties du chatbot, le prompt s'√©largit pour incorporer ce nouvel √©change. C'est ainsi que des chatbots comme Skippy et ChatGPT peuvent **se souvenir des entr√©es pr√©c√©dentes**. Il y a cependant une limite √† ce qu'un chatbot GPT-3 peut m√©moriser.

Les prompts peuvent devenir massifs apr√®s plusieurs √©changes, surtout si nous utilisons le chatbot pour g√©n√©rer de longues r√©ponses comme des articles de blog. Les prompts envoy√©s √† GPT-3 sont convertis en tokens, qui sont des mots individuels ou des parties de ceux-ci. Il existe une limite de <a href="https://help.openai.com/en/articles/4936856-what-are-tokens-and-how-to-count-them">4097 tokens (environ 3000 mots)</a> pour la combinaison du prompt et de la r√©ponse g√©n√©r√©e pour les mod√®les GPT-3, y compris ChatGPT.{" "}

### Quelques Exemples

Il existe de nombreux cas d'utilisation diff√©rents de prompts de chatbot qui stockent les conversations pr√©c√©dentes. ChatGPT est con√ßu pour √™tre un assistant g√©n√©raliste polyvalent et, d'apr√®s mon exp√©rience, il pose rarement des questions de suivi.

#### Chatbot th√©rapeutique qui vous demande comment s'est pass√©e votre journ√©e

Il peut √™tre utile d'avoir un chatbot qui pose activement des questions et obtient des retours de l'utilisateur. Voici un exemple de prompt de chatbot th√©rapeutique qui posera des questions et des suivi pour aider l'utilisateur √† r√©fl√©chir √† sa journ√©e.

<div style={{ textAlign: "left" }}>
  <Image
    src="/docs/assets/basic_applications/therapy_chatbot.gif"
    width={2068}
    height={1080}
    style={{ width: "700px", margin: "0" }}
  />

  <p style={{ color: "gray", fontSize: "12px", fontStyle: "italic" }}>
    Prompt du chatbot th√©rapeutique
  </p>
</div>

#### Discuter avec votre moi plus jeune en utilisant d'anciens journaux intimes

<a href="https://twitter.com/michellehuang42">Michelle Huang</a>
a utilis√© GPT-3 pour avoir une conversation avec son moi plus jeune. Le prompt utilise un contexte sp√©cifique, dans
ce cas des entr√©es d'un ancien journal intime, associ√© √† un format de conversation aller-retour.
GPT-3 est capable d'imiter une personnalit√© bas√©e sur ces entr√©es.

<blockquote class="twitter-tweet">
  <p lang="en" dir="ltr">
    i trained an ai chatbot on my childhood journal entries - so that i could
    engage in real-time dialogue with my &quot;inner child&quot;
    <br />
    <br />
    some reflections below:
  </p>
  &mdash; michelle huang
  <a href="https://twitter.com/michellehuang42/status/1597005489413713921?ref_src=twsrc%5Etfw">
    November 27, 2022
  </a>
</blockquote>

<script
  async
  src="https://platform.twitter.com/widgets.js"
  charset="utf-8"
></script>

Prompt issu du Tweet:

```markdown
The following is a conversation with Present Michelle (age [redacted]) and Young Michelle (age 14).

Young Michelle has written the following journal entries:
[diary entries here]

Present Michelle: [type your questions here]
```

L'auteure note que les entr√©es du journal peuvent atteindre la limite de tokens. Dans ce cas, vous pourriez choisir quelques entr√©es sp√©cifiques ou essayer de r√©sumer plusieurs entr√©es.

## Impl√©mentation

Je vais vous guider √† travers la programmation d'un simple chatbot aliment√© par GPT-3 en Python. Inclure GPT-3 dans une application que vous construisez est incroyablement facile en utilisant l'API OpenAI. Vous devrez cr√©er un compte sur OpenAI et obtenir une cl√© API. Consultez leur documentation <a href="https://beta.openai.com/docs/introduction">ici.</a>

Aper√ßu de ce que nous devons faire :

1. Formater l'entr√©e de l'utilisateur en un prompt de chatbot pour GPT-3
2. Obtenir la r√©ponse du chatbot sous forme de compl√©tion de GPT-3
3. Mettre √† jour le prompt avec √† la fois l'entr√©e de l'utilisateur et la r√©ponse du chatbot
4. Boucler

Voici le prompt que j'utiliserai. Nous pouvons utiliser Python pour remplacer \<conversation history\> et \<user input\> par leurs valeurs r√©elles.

```python
chatbot_prompt = """
    En tant que chatbot avanc√©, votre objectif principal est d'aider les utilisateurs au mieux de vos capacit√©s. Cela peut impliquer de r√©pondre √† des questions, de fournir des informations utiles ou d'accomplir des t√¢ches bas√©es sur l'entr√©e de l'utilisateur. Afin d'aider efficacement les utilisateurs, il est important d'√™tre d√©taill√© et approfondi dans vos r√©ponses. Utilisez des exemples et des preuves pour soutenir vos points et justifier vos recommandations ou solutions.


<conversation history>

    Utilisateur:
<user input>
    Chatbot:"""
```

Je garde une trace √† la fois de la prochaine entr√©e de l'utilisateur et de la conversation pr√©c√©dente. Les nouvelles entr√©es/sorties entre le chatbot et l'utilisateur sont ajout√©es √† chaque boucle.

```python
import openai

openai.api_key = "VOTRE CL√â API ICI"
model_engine = "text-davinci-003"
chatbot_prompt = """
En tant que chatbot avanc√©, votre objectif principal est d'aider les utilisateurs au mieux de vos capacit√©s. Cela peut impliquer de r√©pondre √† des questions, de fournir des informations utiles ou d'accomplir des t√¢ches bas√©es sur l'entr√©e de l'utilisateur. Afin d'aider efficacement les utilisateurs, il est important d'√™tre d√©taill√© et approfondi dans vos r√©ponses. Utilisez des exemples et des preuves pour soutenir vos points et justifier vos recommandations ou solutions.

<conversation history>

Utilisateur:
<user input>
Chatbot:"""


def get_response(conversation_history, user_input):
    prompt = chatbot_prompt.replace("<conversation history>", conversation_history).replace("<user input>", user_input)

    # Obtenir la r√©ponse de GPT-3
    response = openai.Completion.create(
        engine=model_engine, prompt=prompt, max_tokens=2048, n=1, stop=None, temperature=0.5)

    # Extraire la r√©ponse de l'objet de r√©ponse
    response_text = response["choices"][0]["text"]

    chatbot_response = response_text.strip()

    return chatbot_response


def main():
    conversation_history = ""

    while True:
        user_input = input(">")
        if user_input == "exit":
            break
        chatbot_response = get_response(conversation_history, user_input)
        print(f"Chatbot: {chatbot_response}")
        conversation_history += f"Utilisateur: {user_input}\nChatbot: {chatbot_response}\n"

main()
```

<a href="https://gist.github.com/jayo78/79d8834e6e31bf942c7b604e1611b68d">
  Voici un lien
</a>
vers le code complet pour un chatbot simple.

<p></p>

Maintenant, il ne reste plus qu'√† construire une belle interface utilisateur avec laquelle les utilisateurs peuvent interagir !

√âcrit par [jayo78](https://twitter.com/jayo782).
