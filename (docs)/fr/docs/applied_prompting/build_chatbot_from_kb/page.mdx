export const metadata = {
  sidebar_position: 40,
  title: "üü¢ Chatbot + Base de Connaissances",
};

# üü¢ Chatbot + Base de Connaissances

Les r√©centes avanc√©es dans les grands mod√®les de langage (LLMs) tels que [GPT-3](https://arxiv.org/abs/2005.14165) et [ChatGPT](https://chat.openai.com/chat) ont cr√©√© beaucoup d'enthousiasme dans l'industrie technologique. Ces mod√®les sont incroyablement puissants pour la g√©n√©ration de contenu, mais ils pr√©sentent √©galement certains inconv√©nients comme des biais(@nadeem-etal-2021-stereoset) et des hallucinations(@Ji_2022). Un domaine dans lequel ces LLMs peuvent √™tre particuli√®rement utiles est le d√©veloppement de chatbots.

## Chatbots bas√©s sur l'intention

Les chatbots traditionnels sont g√©n√©ralement bas√©s sur l'intention, ce qui signifie qu'ils sont con√ßus pour r√©pondre √† des intentions sp√©cifiques de l'utilisateur. Chaque intention est compos√©e d'un ensemble de questions types et d'une r√©ponse associ√©e. Par exemple, l'intention "M√©t√©o" pourrait inclure des questions comme "Quel temps fait-il aujourd'hui ?" ou "Va-t-il pleuvoir aujourd'hui ?" et une r√©ponse comme "Aujourd'hui sera ensoleill√©." Lorsqu'un utilisateur pose une question, le chatbot l'associe √† l'intention dont les questions types sont les plus similaires et renvoie la r√©ponse associ√©e.

<div style={{ textAlign: "left" }}>
  <Image
    src="/docs/assets/basic_applications/chatbot_from_kb_intents.webp"
    width={2966}
    height={1676}
    style={{ width: "700px", margin: "0" }}
  />

  <p style={{ color: "gray", fontSize: "12px", fontStyle: "italic" }}>
    Comment fonctionne un chatbot traditionnel bas√© sur l'intention. Image par l'auteur.
  </p>
</div>

Cependant, les chatbots bas√©s sur l'intention ont leurs propres probl√®mes. L'un d'eux est qu'ils n√©cessitent un grand nombre d'intentions sp√©cifiques pour donner des r√©ponses pr√©cises. Par exemple, des expressions d'utilisateur comme "Je ne peux pas me connecter", "J'ai oubli√© mon mot de passe" ou "Erreur de connexion" peuvent n√©cessiter trois r√©ponses diff√©rentes et donc trois intentions diff√©rentes, m√™me si elles sont toutes assez similaires.

## Comment GPT-3 peut aider

C'est l√† que GPT-3 peut √™tre particuli√®rement utile. Au lieu d'avoir de nombreuses intentions tr√®s sp√©cifiques, chaque intention peut √™tre plus large et s'appuyer sur un document de votre [Base de Connaissances](https://en.wikipedia.org/wiki/Knowledge_base). Une Base de Connaissances (KB) est compos√©e d'informations stock√©es sous forme de donn√©es structur√©es et non structur√©es, pr√™te √† √™tre utilis√©e pour l'analyse ou l'inf√©rence. Votre KB peut √™tre compos√©e d'une s√©rie de documents expliquant comment utiliser vos produits.

De cette fa√ßon, chaque intention est associ√©e √† un document plut√¥t qu'√† une liste de questions et une r√©ponse sp√©cifique, par exemple une intention pour les "probl√®mes de connexion", une intention pour "comment s'abonner", etc. Lorsqu'un utilisateur pose une question sur la connexion, nous pouvons transmettre le document "probl√®mes de connexion" √† GPT-3 comme information contextuelle et g√©n√©rer une r√©ponse sp√©cifique √† la question de l'utilisateur.

<div style={{ textAlign: "left" }}>
  <Image
    src="/docs/assets/basic_applications/chatbot_from_kb_gpt3.webp"
    width={2962}
    height={1672}
    style={{ width: "700px", margin: "0" }}
  />

  <p style={{ color: "gray", fontSize: "12px", fontStyle: "italic" }}>
    Comment pourrait fonctionner un chatbot utilisant GPT-3. Image par l'auteur.
  </p>
</div>

Cette approche r√©duit le nombre d'intentions √† g√©rer et permet des r√©ponses mieux adapt√©es √† chaque question. De plus, si le document associ√© √† l'intention d√©crit diff√©rents processus (par exemple, un processus pour "se connecter sur le site web" et un autre pour "se connecter sur l'application mobile"), GPT-3 peut automatiquement demander des pr√©cisions √† l'utilisateur avant de donner la r√©ponse finale.

## Pourquoi ne pouvons-nous pas transmettre toute la KB √† GPT-3 ?

Aujourd'hui, les LLMs comme GPT-3 ont une taille maximale de prompt d'environ 4k tokens (pour le mod√®le [`text-davinci-003`](https://beta.openai.com/docs/models/gpt-3)), ce qui est beaucoup mais pas suffisant pour int√©grer une base de connaissances enti√®re dans un seul prompt. Les LLMs ont une taille maximale de prompt pour des raisons computationnelles, car la g√©n√©ration de texte implique un nombre de calculs qui augmente rapidement avec la taille du prompt.

Les futurs LLMs pourraient ne pas avoir cette limitation tout en conservant les capacit√©s de g√©n√©ration de texte. Cependant, pour l'instant, nous devons concevoir une solution qui contourne cette limitation.

## Comment un chatbot avec GPT-3 pourrait fonctionner

Ainsi, le pipeline du chatbot pourrait √™tre compos√© de deux √©tapes :

1. D'abord, nous devons s√©lectionner l'intention appropri√©e pour la question de l'utilisateur, c'est-√†-dire que nous devons r√©cup√©rer le bon document de notre base de connaissances.
2. Ensuite, une fois que nous avons le bon document, nous pouvons utiliser GPT-3 pour g√©n√©rer une r√©ponse appropri√©e pour l'utilisateur. Ce faisant, nous devrons √©laborer un bon prompt.

La premi√®re √©tape est essentiellement r√©solue par la [recherche s√©mantique](https://en.wikipedia.org/wiki/Semantic_search). Nous pouvons utiliser des mod√®les pr√©-entra√Æn√©s de la biblioth√®que [`sentence-transformers`](https://www.sbert.net/examples/applications/semantic-search/README.html) et attribuer facilement un score √† chaque document. Le document avec le score le plus √©lev√© est celui qui sera utilis√© pour g√©n√©rer la r√©ponse du chatbot.

<div style={{ textAlign: "left" }}>
  <Image
    src="/docs/assets/basic_applications/chatbot_from_kb_gpt3_organized.webp"
    width={2960}
    height={1668}
    style={{ width: "700px", margin: "0" }}
  />

  <p style={{ color: "gray", fontSize: "12px", fontStyle: "italic" }}>
    Comment pourrait fonctionner un chatbot utilisant GPT-3. GPT-3 pourrait √™tre utilis√© pour g√©n√©rer
    une r√©ponse appropri√©e en s'appuyant sur les informations des documents de la base de connaissances.
    Image par l'auteur.
  </p>
</div>

## G√©n√©ration de r√©ponses avec GPT-3

Une fois que nous avons le bon document, nous devrons cr√©er un bon prompt √† utiliser avec GPT-3 pour g√©n√©rer la r√©ponse. Dans les exp√©riences suivantes, nous utiliserons toujours le mod√®le `text-davinci-003` avec une temp√©rature de `0.7`.

Pour √©laborer le prompt, nous exp√©rimenterons en utilisant :

- [**Role-prompting**](https://learnprompting.org/docs/basics/roles) : une technique heuristique qui attribue un r√¥le sp√©cifique √† l'IA.
- **Informations pertinentes de la KB**, c'est-√†-dire le document r√©cup√©r√© lors de l'√©tape de recherche s√©mantique.
- **Les derniers messages √©chang√©s entre l'utilisateur et le chatbot**. Ces derniers sont utiles pour les messages envoy√©s par l'utilisateur o√π le contexte complet n'est pas sp√©cifi√©. Nous verrons un exemple plus tard. Consultez [cet exemple](https://learnprompting.org/docs/applied_prompting/build_chatgpt) pour voir comment g√©rer les conversations avec GPT-3.
- Enfin, **la question de l'utilisateur**.

<div style={{ textAlign: "left" }}>
  <Image
    src="/docs/assets/basic_applications/chatbot_from_kb_prompt.webp"
    width={2960}
    height={1664}
    style={{ width: "700px", margin: "0" }}
  />

  <p style={{ color: "gray", fontSize: "12px", fontStyle: "italic" }}>
    Informations utilis√©es pour √©laborer notre prompt GPT-3. Image par l'auteur.
  </p>
</div>

Commen√ßons notre prompt en utilisant la technique de <span className="yellow-highlight">role-prompting</span>.

<pre>
  <span className="yellow-highlight">
    En tant que chatbot avanc√© nomm√© Skippy, votre objectif principal est d'aider les utilisateurs du mieux que vous le pouvez.
  </span>
</pre>

Ensuite, supposons que l'√©tape de recherche s√©mantique extrait le document suivant de notre base de connaissances. Tous les documents d√©crivent comment le produit VideoGram fonctionne, qui est un produit imaginaire similaire √† Instagram, mais uniquement pour les vid√©os.

<div style={{ textAlign: "left" }}>
  <Image
    src="/docs/assets/basic_applications/chatbot_from_kb_login.webp"
    width={2956}
    height={1664}
    style={{ width: "700px", margin: "0" }}
  />

  <p style={{ color: "gray", fontSize: "12px", fontStyle: "italic" }}>
    Un document expliquant comment se connecter √† VideoGram. Image par l'auteur.
  </p>
</div>

Nous pouvons ajouter <span className="yellow-highlight">son contenu</span> au prompt de la mani√®re suivante.

<pre>
  En tant que chatbot avanc√© nomm√© Skippy, votre objectif principal est d'aider les utilisateurs du mieux que vous le pouvez.
  <br />
  <span className="yellow-highlight">
    D√âBUT CONTEXTE Connexion √† VideoGram depuis le site web 1. Ouvrez votre navigateur web et acc√©dez au site web de VideoGram. 2. Cliquez sur le bouton "Connexion" situ√© dans le coin sup√©rieur droit de la page. 3. Sur la page de connexion, entrez votre nom d'utilisateur et votre mot de passe VideoGram. 4. Une fois que vous avez saisi vos identifiants, cliquez sur le bouton "Connexion". 5. Vous devriez maintenant √™tre connect√© √† votre compte VideoGram.
    <br />
    Connexion √† VideoGram depuis l'application mobile 1. Ouvrez l'application VideoGram sur votre appareil mobile. 2. Sur la page principale, appuyez sur le bouton "Connexion" situ√© dans le coin inf√©rieur droit. 3. Sur la page de connexion, entrez votre nom d'utilisateur et votre mot de passe VideoGram. 4. Une fois que vous avez saisi vos identifiants, appuyez sur le bouton "Connexion". 5. Vous devriez maintenant √™tre connect√© √† votre compte VideoGram. FIN CONTEXTE
  </span>
</pre>

Enfin, nous devons ajouter <span className="yellow-highlight">la conversation et la question de l'utilisateur</span> √† la fin du prompt, comme dans l'exemple suivant.

<pre>
  En tant que chatbot avanc√© nomm√© Skippy, votre objectif principal est d'aider les utilisateurs du mieux que vous le pouvez.
  <br />
  D√âBUT CONTEXTE Connexion √† VideoGram depuis le site web 1. Ouvrez votre navigateur web et acc√©dez au site web de VideoGram. 2. Cliquez sur le bouton "Connexion" situ√© dans le coin sup√©rieur droit de la page. 3. Sur la page de connexion, entrez votre nom d'utilisateur et votre mot de passe VideoGram. 4. Une fois que vous avez saisi vos identifiants, cliquez sur le bouton "Connexion". 5. Vous devriez maintenant √™tre connect√© √† votre compte VideoGram.
  <br />
  Connexion √† VideoGram depuis l'application mobile 1. Ouvrez l'application VideoGram sur votre appareil mobile. 2. Sur la page principale, appuyez sur le bouton "Connexion" situ√© dans le coin inf√©rieur droit. 3. Sur la page de connexion, entrez votre nom d'utilisateur et votre mot de passe VideoGram. 4. Une fois que vous avez saisi vos identifiants, appuyez sur le bouton "Connexion". 5. Vous devriez maintenant √™tre connect√© √† votre compte VideoGram. FIN CONTEXTE
  <br />
  <span className="yellow-highlight">
    SKIPPY : Bonjour, je suis Skippy ! Comment puis-je vous aider ? UTILISATEUR : Je ne trouve pas le bouton de connexion. SKIPPY :
  </span>
</pre>

En passant ce prompt √† GPT-3, j'ai obtenu la r√©ponse g√©n√©r√©e suivante.

<pre>
  <span className="bluegreen-highlight">
    Pas de probl√®me ! Sur le site web, le bouton de connexion est situ√© dans le coin sup√©rieur droit de la page. Sur l'application mobile, le bouton de connexion est situ√© dans le coin inf√©rieur droit. N'h√©sitez pas √† me demander si vous avez besoin d'autres informations !
  </span>
</pre>

Remarquez comment les informations dans la r√©ponse g√©n√©r√©e proviennent du document de la base de connaissances.

## D√©sambigu√Øsation des questions avec GPT-3

Essayons avec une expression d'utilisateur plus vague, comme <span className="yellow-highlight">"impossible de me connecter"</span>. Voici le prompt complet.

<pre>
  En tant que chatbot avanc√© nomm√© Skippy, votre objectif principal est d'aider les utilisateurs du mieux que vous le pouvez.
  <br />
  D√âBUT CONTEXTE Connexion √† VideoGram depuis le site web 1. Ouvrez votre navigateur web et acc√©dez au site web de VideoGram. 2. Cliquez sur le bouton "Connexion" situ√© dans le coin sup√©rieur droit de la page. 3. Sur la page de connexion, entrez votre nom d'utilisateur et votre mot de passe VideoGram. 4. Une fois que vous avez saisi vos identifiants, cliquez sur le bouton "Connexion". 5. Vous devriez maintenant √™tre connect√© √† votre compte VideoGram.
  <br />
  Connexion √† VideoGram depuis l'application mobile 1. Ouvrez l'application VideoGram sur votre appareil mobile. 2. Sur la page principale, appuyez sur le bouton "Connexion" situ√© dans le coin inf√©rieur droit. 3. Sur la page de connexion, entrez votre nom d'utilisateur et votre mot de passe VideoGram. 4. Une fois que vous avez saisi vos identifiants, appuyez sur le bouton "Connexion". 5. Vous devriez maintenant √™tre connect√© √† votre compte VideoGram. FIN CONTEXTE
  <br />
  SKIPPY : Bonjour, je suis Skippy ! Comment puis-je vous aider ? UTILISATEUR :{" "}
  <span className="yellow-highlight">Impossible de me connecter</span>
  SKIPPY :
</pre>

GPT-3 r√©pond en essayant de mieux comprendre quel est le probl√®me de l'utilisateur.

<pre>
  <span className="bluegreen-highlight">
    Je suis d√©sol√© d'entendre cela. Pouvez-vous me dire si vous essayez de vous connecter via le site web de VideoGram ou via l'application mobile ?
  </span>
</pre>

Voici comment se d√©roule la conversation compl√®te. Le prompt complet est masqu√© pour une meilleure visibilit√©.

<pre>
  UTILISATEUR : Impossible de me connecter
  <br />
  SKIPPY : Je suis d√©sol√© d'entendre cela. Pouvez-vous me dire si vous essayez de vous connecter via le site web de VideoGram ou via l'application mobile ?
  <br />
  UTILISATEUR : Application mobile
  <br />
  <span className="bluegreen-highlight">
    SKIPPY : D'accord, pas de probl√®me. Pour vous connecter via l'application mobile, ouvrez l'application VideoGram sur votre appareil mobile. Sur la page principale, appuyez sur le bouton "Connexion" situ√© dans le coin inf√©rieur droit. Sur la page de connexion, entrez votre nom d'utilisateur et votre mot de passe VideoGram. Une fois que vous avez saisi vos identifiants, appuyez sur le bouton "Connexion". Vous devriez maintenant √™tre connect√© √† votre compte VideoGram. N'h√©sitez pas √† me faire savoir si vous avez besoin d'autres informations.
  </span>
</pre>

GPT-3 peut g√©rer la d√©sambigu√Øsation, √† condition qu'il dispose des informations contextuelles appropri√©es.

## Probl√®mes avec la g√©n√©ration de r√©ponses avec GPT-3

Les exemples pr√©c√©dents ont bien fonctionn√©. Cependant, il existe plusieurs fa√ßons dont ce chatbot pourrait √©chouer.

Si nous demandons "L'application mobile est-elle gratuite ?" √† GPT-3 en passant le document de connexion comme contexte, vous obtiendrez souvent une r√©ponse comme "Oui, l'application mobile VideoGram est gratuite √† t√©l√©charger et √† utiliser", m√™me si cette information n'est pas contenue dans le contexte. G√©n√©rer de fausses informations est tr√®s mauvais pour les chatbots de service client !

GPT-3 g√©n√®re rarement de fausses informations lorsque la r√©ponse √† la question de l'utilisateur peut √™tre trouv√©e dans le contexte. Comme les questions des utilisateurs sont souvent des textes courts et ambigus, nous ne pouvons pas compter sur l'√©tape de recherche s√©mantique pour toujours r√©cup√©rer un document correct, et nous sommes donc toujours vuln√©rables √† la g√©n√©ration de fausses informations.

## Conclusion

GPT-3 est tr√®s utile pour cr√©er des chatbots conversationnels et est capable de r√©pondre √† une s√©rie de questions sp√©cifiques sur la base d'informations contextuelles ins√©r√©es dans le prompt. Cependant, il est difficile de faire en sorte que le mod√®le produise des r√©ponses s'appuyant uniquement sur les informations du contexte, car le mod√®le a tendance √† halluciner (c'est-√†-dire √† g√©n√©rer de nouvelles informations, potentiellement fausses). G√©n√©rer de fausses informations est un probl√®me de gravit√© diff√©rente selon le cas d'utilisation.

√âcrit par [Fabio Chiusano](https://www.linkedin.com/in/fabio-chiusano-b6a3b311b/).
